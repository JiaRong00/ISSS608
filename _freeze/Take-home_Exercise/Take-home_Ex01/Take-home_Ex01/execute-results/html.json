{
  "hash": "e7c1f1003359b27fce0ad6c06c9211b6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1\"\nformat:\n  html:\n    fontcolor: '#3b3b3b'\n    code-line-numbers: true\nauthor: \"Moo Jia Rong\"\ndate: \"February 1, 2025\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true \n---\n\n\n\n### **1 Overview**\n\n#### **1.1 Background**\n\nHeart attack is one of the leading causes of mortality globally. According to findings of [research studies](https://www.sciencedaily.com/releases/2019/03/190307081026.htm), heart attacks are increasingly common in young adults (aged 40 or below). The alarming trend highlights a need to understand the potential causes and risk factors of early heart attacks through examining the profiles of young adult and older adult patients, including demographic, lifestyle factors and medical history, to enable early detection and enforcement of preventive measures.\n\n#### **1.2 Dataset**\n\nIn this exercise, we have obtained a dataset on heart attack incidents in Japan from [Kaggle](https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult), consisting of data on individuals aged 18 to 79.\n\n#### **1.3 Objectives**\n\nAs part of an international media company that publishes weekly content on digital platforms, we will Use the Japan heart attack dataset to perform Exploratory Data Analysis and generate statistical visualisations for an article, covering insights on:\n\n(1) The general profile of Japan population\n(2) Trends and associations of heart attack occurrence with demographic, lifestyle factors and medical history in the Japan populations.\n(3) Age-specific factors for heart attack occurrence\n\n### **2 Getting Started**\n\n#### **2.1 Loading Packages**\n\nThe R packages used in this exercise includes:\n\n-   tidyverse (i.e. readr, tidyr, dplyr, ggplot2) for performing data science tasks such as importing, tidying, and wrangling data, as well as creating graphs\n-   knitr for displaying tables\n-   patchwork for preparing composite figure created using ggplot2\n-   ggstats for creating diverging barplots\n-   ggdist for visualising distributions and uncertainty\n-   ggmosaic for creating mosaic plots\n-   ggstatsplot for visualising significant test of association using stacked barplots\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse,knitr, patchwork,ggstats, ggdist,ggmosaic, ggstatsplot)\n```\n:::\n\n\n\n#### **2.2 Importing Data**\n\nThe dataset used in this exercise is the *japan_heart_attack_dataset.csv* file downloaded from Kaggle. The file is imported into R environment using `read_csv()`.\n\nUsing the `glimpse()` function, we observe that the dataset consists of 30,000 records spanning across 32 columns. Of which, there are 17 relevant variables and 15 extra column variables which are irrelevant to our analysis.\n\nIn addition, by viewing the first few entries of each column, we can see that there are both categorical and continuous variables in the dataset.\n\nWith a focus on the 17 relevant variables, a data dictionary table is generated, showing the range for the 7 continuous variables and the unique values for the 10 categorical variables.\n\n::: panel-tabset\n## Import data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheart_attack <- read_csv(\"data/japan_heart_attack_dataset.csv\")\n```\n:::\n\n\n\n## Glimpse data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(heart_attack)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30,000\nColumns: 32\n$ Age                     <dbl> 56, 69, 46, 32, 60, 25, 78, 38, 56, 75, 36, 40…\n$ Gender                  <chr> \"Male\", \"Male\", \"Male\", \"Female\", \"Female\", \"F…\n$ Region                  <chr> \"Urban\", \"Urban\", \"Rural\", \"Urban\", \"Rural\", \"…\n$ Smoking_History         <chr> \"Yes\", \"No\", \"Yes\", \"No\", \"No\", \"No\", \"No\", \"Y…\n$ Diabetes_History        <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"Yes\", \"No…\n$ Hypertension_History    <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"Yes\", \"No…\n$ Cholesterol_Level       <dbl> 186.4002, 185.1367, 210.6966, 211.1655, 223.81…\n$ Physical_Activity       <chr> \"Moderate\", \"Low\", \"Low\", \"Moderate\", \"High\", …\n$ Diet_Quality            <chr> \"Poor\", \"Good\", \"Average\", \"Good\", \"Good\", \"Go…\n$ Alcohol_Consumption     <chr> \"Low\", \"Low\", \"Moderate\", \"High\", \"High\", \"Hig…\n$ Stress_Levels           <dbl> 3.644786, 3.384056, 3.810911, 6.014878, 6.8068…\n$ BMI                     <dbl> 33.96135, 28.24287, 27.60121, 23.71729, 19.771…\n$ Heart_Rate              <dbl> 72.30153, 57.45764, 64.65870, 55.13147, 76.667…\n$ Systolic_BP             <dbl> 123.90209, 129.89331, 145.65490, 131.78522, 10…\n$ Diastolic_BP            <dbl> 85.68281, 73.52426, 71.99481, 68.21133, 92.902…\n$ Family_History          <chr> \"No\", \"Yes\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No…\n$ Heart_Attack_Occurrence <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\"…\n$ Extra_Column_1          <dbl> 0.40498852, 0.03627815, 0.85297888, 0.39085280…\n$ Extra_Column_2          <dbl> 0.43330004, 0.51256694, 0.21959083, 0.29684675…\n$ Extra_Column_3          <dbl> 0.62871236, 0.66839275, 0.61343656, 0.15572404…\n$ Extra_Column_4          <dbl> 0.70160955, 0.11552874, 0.50800995, 0.87025144…\n$ Extra_Column_5          <dbl> 0.49814235, 0.42381938, 0.90066981, 0.39035591…\n$ Extra_Column_6          <dbl> 0.007901312, 0.083932768, 0.227205241, 0.40318…\n$ Extra_Column_7          <dbl> 0.79458257, 0.68895108, 0.49634358, 0.74140891…\n$ Extra_Column_8          <dbl> 0.29077922, 0.83016364, 0.75210679, 0.22396813…\n$ Extra_Column_9          <dbl> 0.49719307, 0.63449028, 0.18150125, 0.32931387…\n$ Extra_Column_10         <dbl> 0.52199452, 0.30204337, 0.62918031, 0.14319054…\n$ Extra_Column_11         <dbl> 0.79965663, 0.04368285, 0.01827617, 0.90778075…\n$ Extra_Column_12         <dbl> 0.72239788, 0.45166789, 0.06322702, 0.54232201…\n$ Extra_Column_13         <dbl> 0.1487387, 0.8786714, 0.1465122, 0.9224606, 0.…\n$ Extra_Column_14         <dbl> 0.8340099, 0.5356022, 0.9972962, 0.6262165, 0.…\n$ Extra_Column_15         <dbl> 0.061632229, 0.617825340, 0.974455410, 0.22860…\n```\n\n\n:::\n:::\n\n\n\n## Data dictionary\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\ndata_dict <- data.frame(matrix(ncol = 3, nrow = 0))\nx <- c(\"Variable\", \"Type\", \"Values\")\ncolnames(data_dict) <- x\n\ncolumn_names <- colnames(heart_attack)[1:17]\nfor (column in column_names){\n  values <- heart_attack[, column]\n  if (class(heart_attack[[column]])==\"numeric\"){\n    col_label<-paste0(\"(\", round(min(values), digits=2), \", \", round(max(values), digits=2), \")\")\n    col_type=\"Continuous\"\n  }\n  else {\n    col_label<-paste0(unique(values))\n    col_type=\"Categorical\"\n  }\n  new.row <- data.frame(Variable = column, Type = col_type , Values = col_label)\n  data_dict <- rbind(data_dict, new.row)\n  \n}\n\ndata_dict[\"Description\"]<- c(\"\",\"\",\"\",\"\",\"\", \"Patient hypertension ( high blood pressure) history\n\", \"normal total cholesterol level (mg/dL) < 200 \n\", \"\",\"\",\"\",\"\", \"Healthy BMI range is 18.5 to 24.9\n\", \"\", \"Normal systolic  blood pressure (mmHg) <120 \n\", \"Normal diastolic  blood pressure (mmHg) <80\n\", \"\",\"\")\n\nknitr::kable(data_dict, \"html\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:left;\"> Type </th>\n   <th style=\"text-align:left;\"> Values </th>\n   <th style=\"text-align:left;\"> Description </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Age </td>\n   <td style=\"text-align:left;\"> Continuous </td>\n   <td style=\"text-align:left;\"> (18, 79) </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gender </td>\n   <td style=\"text-align:left;\"> Categorical </td>\n   <td style=\"text-align:left;\"> c(\"Male\", \"Female\") </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region </td>\n   <td style=\"text-align:left;\"> Categorical </td>\n   <td style=\"text-align:left;\"> c(\"Urban\", \"Rural\") </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Smoking_History </td>\n   <td style=\"text-align:left;\"> Categorical </td>\n   <td style=\"text-align:left;\"> c(\"Yes\", \"No\") </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Diabetes_History </td>\n   <td style=\"text-align:left;\"> Categorical </td>\n   <td style=\"text-align:left;\"> c(\"No\", \"Yes\") </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hypertension_History </td>\n   <td style=\"text-align:left;\"> Categorical </td>\n   <td style=\"text-align:left;\"> c(\"No\", \"Yes\") </td>\n   <td style=\"text-align:left;\"> Patient hypertension ( high blood pressure) history </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cholesterol_Level </td>\n   <td style=\"text-align:left;\"> Continuous </td>\n   <td style=\"text-align:left;\"> (80.02, 336.86) </td>\n   <td style=\"text-align:left;\"> normal total cholesterol level (mg/dL) &lt; 200 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Physical_Activity </td>\n   <td style=\"text-align:left;\"> Categorical </td>\n   <td style=\"text-align:left;\"> c(\"Moderate\", \"Low\", \"High\") </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Diet_Quality </td>\n   <td style=\"text-align:left;\"> Categorical </td>\n   <td style=\"text-align:left;\"> c(\"Poor\", \"Good\", \"Average\") </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Alcohol_Consumption </td>\n   <td style=\"text-align:left;\"> Categorical </td>\n   <td style=\"text-align:left;\"> c(\"Low\", \"Moderate\", \"High\", \"None\") </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Stress_Levels </td>\n   <td style=\"text-align:left;\"> Continuous </td>\n   <td style=\"text-align:left;\"> (0, 10) </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> BMI </td>\n   <td style=\"text-align:left;\"> Continuous </td>\n   <td style=\"text-align:left;\"> (5.58, 46.1) </td>\n   <td style=\"text-align:left;\"> Healthy BMI range is 18.5 to 24.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Heart_Rate </td>\n   <td style=\"text-align:left;\"> Continuous </td>\n   <td style=\"text-align:left;\"> (30.03, 108.78) </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Systolic_BP </td>\n   <td style=\"text-align:left;\"> Continuous </td>\n   <td style=\"text-align:left;\"> (56.23, 178.77) </td>\n   <td style=\"text-align:left;\"> Normal systolic  blood pressure (mmHg) &lt;120 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Diastolic_BP </td>\n   <td style=\"text-align:left;\"> Continuous </td>\n   <td style=\"text-align:left;\"> (39.95, 117.67) </td>\n   <td style=\"text-align:left;\"> Normal diastolic  blood pressure (mmHg) &lt;80 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Family_History </td>\n   <td style=\"text-align:left;\"> Categorical </td>\n   <td style=\"text-align:left;\"> c(\"No\", \"Yes\") </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Heart_Attack_Occurrence </td>\n   <td style=\"text-align:left;\"> Categorical </td>\n   <td style=\"text-align:left;\"> c(\"No\", \"Yes\") </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n### **3 Data Wrangling**\n\n#### **3.1 Removing irrelevant data**\n\nWe first remove the 15 'extra columns' in the dataset, which are irrelvant for our analysis, using the code below.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf<-heart_attack[, 1:17]\n```\n:::\n\n\n\nThis leaves us with just 17 variables:\n\n[General Demographic Variables]{.underline}\n\n-   Age\n-   Gender\n-   Region\n-   BMI\n\n[Lifestyle Factors]{.underline}\n\n-   Smoking_History\n-   Physical_Activity\n-   Diet_Quality\n-   Alcohol_Consumption\n-   Stress_Levels\n\n[Medical History]{.underline}\n\n-   Diabetes_History\n-   Hypertension_History\n-   Cholesterol_Level\n-   Heart_Rate\n-   Systolic_BP\n-   Diastolic_BP\n-   Family_History\n-   Heart_Attack_Occurrence\n\n#### **3.2 Check for duplicated or missing values**\n\nNext, the `duplicated()` and `is.na()` functions are used to check for duplicate records and missing values in the dataset respectively.\n\nThere are no duplicated records or missing values in this dataset.\n\n::: panel-tabset\n## Duplicated records\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf[duplicated(df),]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 0 × 17\n# ℹ 17 variables: Age <dbl>, Gender <chr>, Region <chr>, Smoking_History <chr>,\n#   Diabetes_History <chr>, Hypertension_History <chr>,\n#   Cholesterol_Level <dbl>, Physical_Activity <chr>, Diet_Quality <chr>,\n#   Alcohol_Consumption <chr>, Stress_Levels <dbl>, BMI <dbl>,\n#   Heart_Rate <dbl>, Systolic_BP <dbl>, Diastolic_BP <dbl>,\n#   Family_History <chr>, Heart_Attack_Occurrence <chr>\n```\n\n\n:::\n:::\n\n\n\n## Missing values\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(df))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n\n:::\n\n#### **3.3 Recode Age**\n\nThe age distribution in the population is shown in the histogram below. There is a relatively even spread of records from young to old.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nggplot(df, aes(Age)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"black\", \n                 fill=\"#7F948F\") +\n  labs(title = \"Frequency of Age\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\nTo facilitate comparison of profiles of younger versus older heart attack patients, we can create a new variable named *Age_Group* to bin the records into different age groups using `ifelse` statements:\n\n1)  Young Adults: 18-39\n2)  Middle-aged Adults: 40-65\n3)  Old Adults: 66-79\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$Age_Groups <- ifelse(df$Age<=35, \"Young\", ifelse(df$Age<=65, \"Middle-aged\", \"Old\"))\n```\n:::\n\n\n\n#### **3.4 Recode BMI**\n\nThe BMI distribution in the population is shown in the histogram below. We can observe that the BMI distribution resembles a normal distribution and about half of the population has BMI \\> 25, which is above the healthy range. For better comparisons in our analyses, we should bin BMI.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nggplot(df, aes(BMI)) +\n  geom_histogram(boundary = 100,\n                 color=\"black\", \n                 fill=\"#7F948F\") +\n  labs(title = \"Frequency of BMI\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\nBMI can be further categorised according to the criterion below, according to definition by Centers for Disease Control and Prevention:\n\n-   Underweight: \\<18.5\n-   Normal: 18.5 to \\<25\n-   Overweight: 25 to \\<30\n-   Obese: ≥30\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$BMI_Category <- ifelse(df$BMI<18.5, \"Underweight\", \n                          ifelse(df$BMI<25, \"Normal\", \n                                 ifelse(df$BMI<30, \"Overweight\", \"Obese\")))\n```\n:::\n\n\n\n#### **3.5 Creating blood pressure variable**\n\nAs the dataset provides the Systolic and Diastolic Blood Pressures, we can use these information to further categorise the population based on their blood pressure category, according to the criterion shown in the figure below.\n\n![Source: American Heart Association](images/clipboard-3164247285.png)\n\nThe distribution of the Systolic and Diastolic blood pressures are shown in the figure below. There are no records with hypertensive crisis (Systolic BP \\> 180 mmHg or Diastolic BP \\> 120 mmHg). Therefore, we will only have 4 blood pressure groups: Normal, Elevated, Hypertension I and Hypertension II.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\np1<-ggplot(df, aes(Systolic_BP)) +\n  geom_histogram(bins=20,\n                 boundary = 100,\n                 color=\"black\", \n                 fill=\"thistle\") +\n  scale_x_continuous(n.breaks = 10) +\n  labs(title = \"Frequency of Systolic BP\") +\n  xlab(\"Systolic BP (mmHg)\")\n\np2<-ggplot(df, aes(Diastolic_BP)) +\n  geom_histogram(bins=20,\n                 boundary = 100,\n                 color=\"black\", \n                 fill=\"lightsteelblue\") +\n  labs(title = \"Frequency of Diastolic BP\")+\n  xlab(\"Diastolic BP (mmHg)\")\n\np1 + p2 + plot_annotation(tag_levels = 'I')\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$Blood_Pressure <- ifelse(df$Systolic_BP<120 & df$Diastolic_BP<80, \"Normal\", \n                            ifelse(df$Systolic_BP<130 & df$Diastolic_BP<80, \"Elevated\", \n                                   ifelse((df$Systolic_BP>=130 & df$Systolic_BP<140)|\n                                            ( df$Diastolic_BP<90 & df$Diastolic_BP>=80), \"Hypertension I\", \"Hypertension II\")))\n```\n:::\n\n\n\n#### **3.6 Recode Cholesterol Level**\n\nTotal Cholesterol Level can also be further categorised according to the criterion below:\n\n![Source: Singapore Heart Foundation](images/clipboard-3010395143.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$Cholesterol_Category <- ifelse(df$Cholesterol_Level<200, \"Normal\", ifelse(df$Cholesterol_Level<240, \"Borderline High\", \"High\"))\n```\n:::\n\n\n\n#### **3.7 Ordering levels for ordinal categorical variables**\n\nFor ordinal categorical variables, we will order the different levels in an ascending order using `factor()`, so that the results will be displayed according to the order we have set in the graphs we will plot subsequently in our analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$Physical_Activity <- factor(df$Physical_Activity, \n                               levels = c(\"Low\", \"Moderate\", \"High\"), ordered = TRUE )\n\ndf$Diet_Quality <- factor(df$Diet_Quality, \n                          levels = c(\"Poor\", \"Average\", \"Good\"), ordered = TRUE)\n\ndf$Alcohol_Consumption <- factor(df$Alcohol_Consumption, \n                                 levels = c(\"None\", \"Low\", \"Moderate\", \"High\"), ordered = TRUE)\n\ndf$Age_Groups <- factor(df$Age_Groups, \n                                 levels = c(\"Young\", \"Middle-aged\", \"Old\"), ordered = TRUE)\n\ndf$BMI_Category <- factor(df$BMI_Category, \n                                 levels = c(\"Underweight\", \"Normal\", \"Overweight\", \"Obese\"), ordered = TRUE)\n\ndf$Blood_Pressure <- factor(df$Blood_Pressure, \n                                 levels = c(\"Normal\", \"Elevated\", \"Hypertension I\", \"Hypertension II\"), ordered = TRUE)\n\ndf$Cholesterol_Category <- factor(df$Cholesterol_Category, \n                                 levels = c(\"Normal\", \"Borderline High\", \"High\"), ordered = TRUE)\n```\n:::\n\n\n\nThe first 5 results of the final dataset are displayed below using `kable()` of the knitr package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(head(df, n=5), caption = \"Heart Attack in Japan\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Heart Attack in Japan\n\n| Age|Gender |Region |Smoking_History |Diabetes_History |Hypertension_History | Cholesterol_Level|Physical_Activity |Diet_Quality |Alcohol_Consumption | Stress_Levels|      BMI| Heart_Rate| Systolic_BP| Diastolic_BP|Family_History |Heart_Attack_Occurrence |Age_Groups  |BMI_Category |Blood_Pressure  |Cholesterol_Category |\n|---:|:------|:------|:---------------|:----------------|:--------------------|-----------------:|:-----------------|:------------|:-------------------|-------------:|--------:|----------:|-----------:|------------:|:--------------|:-----------------------|:-----------|:------------|:---------------|:--------------------|\n|  56|Male   |Urban  |Yes             |No               |No                   |          186.4002|Moderate          |Poor         |Low                 |      3.644786| 33.96135|   72.30153|    123.9021|     85.68281|No             |No                      |Middle-aged |Obese        |Hypertension I  |Normal               |\n|  69|Male   |Urban  |No              |No               |No                   |          185.1367|Low               |Good         |Low                 |      3.384056| 28.24287|   57.45764|    129.8933|     73.52426|Yes            |No                      |Old         |Overweight   |Elevated        |Normal               |\n|  46|Male   |Rural  |Yes             |No               |No                   |          210.6966|Low               |Average      |Moderate            |      3.810911| 27.60121|   64.65870|    145.6549|     71.99481|No             |No                      |Middle-aged |Overweight   |Hypertension II |Borderline High      |\n|  32|Female |Urban  |No              |No               |No                   |          211.1655|Moderate          |Good         |High                |      6.014878| 23.71729|   55.13147|    131.7852|     68.21133|No             |No                      |Young       |Normal       |Hypertension I  |Borderline High      |\n|  60|Female |Rural  |No              |No               |No                   |          223.8143|High              |Good         |High                |      6.806883| 19.77158|   76.66792|    100.6946|     92.90249|No             |No                      |Middle-aged |Normal       |Hypertension II |Borderline High      |\n\n\n:::\n:::\n\n\n\n### **4 Exploratory Data Analysis and Statistical Visualisations**\n\nIn this section, we will be conducting Exploratory Data Analysis on the processed dataset named *df*.\n\nBefore diving into the analysis, we first take a look at the distribution of some of the key variables closely-linked to heart attack in the Japan population: Age group, Cholesterol Level, Blood Pressure, BMI category and heart attack occurrence.\n\nThe `ggplot()` and `geom_bar()` functions from the *ggplot2* package was used to generate the bar charts. `stat = 'count'` argument and `geom_text()` was used to add percentage annotations onto the bar chart. The bar chart colors were set using `scale_fill_manual()`. The axis labels were defined using `labs()`. The aesthetics of the bar charts were further customised using `theme()`. Individual plots were combined using *patchwork* package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\np1<-ggplot(data=df,aes(x=Age_Groups, fill=Age_Groups))+\n  geom_bar(stat = \"count\")+\n  scale_fill_manual(values=c(\"lightsteelblue\",\"lightcyan3\",\"thistle\"))+\n  geom_text(\n    aes(\n      label = scales::percent(..count../sum(..count..), accuracy = 0.1)  # Calculate percentage using sum of counts\n    ),\n    stat = \"count\",\n    vjust = 1.25,  # Adjust text placement \n    size=3\n  ) +\n  theme(axis.ticks.x = element_blank(), legend.position = \"None\")+\n  labs(x = \"Age Group\")\n\np2<-ggplot(data=df,aes(x=Blood_Pressure, fill=Blood_Pressure))+\n  geom_bar(stat = \"count\")+\n  scale_fill_manual(values=c(\"lightsteelblue\",\"lightcyan3\",\"thistle\",\"rosybrown2\" ))+\n  geom_text(\n    aes(\n      label = scales::percent(..count../sum(..count..), accuracy = 0.1)  # Calculate percentage using sum of counts\n    ),\n    stat = \"count\",\n    vjust = 1.25,  # Adjust text placement \n    size=3\n  ) +\n  theme( axis.ticks.x = element_blank(), legend.position = \"None\" )+\n  labs(x = \"Blood Pressure\")\n\np3<- ggplot(data=df,aes(x=Heart_Attack_Occurrence, fill=Heart_Attack_Occurrence))+\n  geom_bar(stat = \"count\")+\n  scale_fill_manual(values=c(\"lightsteelblue\",\"thistle\" ))+\n  geom_text(\n    aes(\n      label = scales::percent(..count../sum(..count..), accuracy = 0.1)  # Calculate percentage using sum of counts\n    ),\n    stat = \"count\",\n    vjust = 1.05,  # Adjust text placement \n    size=3\n  ) +\n  theme( axis.ticks.x = element_blank(), legend.position = \"None\" )+\n  labs(x = \"Heart Attack Occurrence\")\n\np4<- ggplot(data=df,aes(x=BMI_Category, fill=BMI_Category))+\n  geom_bar(stat = \"count\")+\n  scale_fill_manual(values=c(\"lightsteelblue\",\"lightcyan3\",\"thistle\",\"rosybrown2\" ))+\n  geom_text(\n    aes(\n      label = scales::percent(..count../sum(..count..), accuracy = 0.1)  # Calculate percentage using sum of counts\n    ),\n    stat = \"count\",\n    vjust = 1.25,  # Adjust text placement \n    size=3\n  ) +\n  theme( axis.ticks.x = element_blank(), legend.position = \"None\" )+\n  labs(x = \"BMI Category\", fill=\"BMI\")\n\np5<- ggplot(data=df,aes(x=Cholesterol_Category, fill=Cholesterol_Category))+\n  geom_bar(stat = \"count\")+\n  scale_fill_manual(values=c(\"lightsteelblue\",\"lightcyan3\",\"thistle\"))+\n  geom_text(\n    aes(\n      label = scales::percent(..count../sum(..count..), accuracy = 0.1)  # Calculate percentage using sum of counts\n    ),\n    stat = \"count\",\n    vjust = 1.25,  # Adjust text placement \n    size=3\n  ) +\n  theme(axis.ticks.x = element_blank(), legend.position = \"None\")+\n  labs(x = \"Cholesterol Level\")\n\n(p1+p5)/(p3+p4)/p2+ plot_annotation(title= \"Overview of Japan Population Profile\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n::: {.callout-note icon=\"false\"}\n## Insights\n\n-   The study population primarily consist of Middle-aged (40-65), followed by Young adults (18-39) and Old adults (\\>65).\n-   About 10% have experienced heart attack, indicating high prevalence of heart attack in Japan and underscores importance of addressing cardiovascular health.\n-   Alarmingly, only 25.2% have normal blood pressure, with 62.6% suffering from hypertension. Prolonged hypertension is a well-documented contributor to cardiovascular diseases, including heart attacks and strokes.\n-   Nearly half of the population (49.8%) are either overweight or obese, which is known to be a significant risk factor for heart attack occurrence and correlates with other comorbidities such as diabetes and high cholesterol, exacerbating health conditions.\n-   Similarly, approximately half of the population have elevated cholesterol levels.\n-   The high incidence of hypertension, overweight/obesity and high cholesterol highlights a need for targeted public health campaigns to increase awareness to promote healthy lifestyles and targeted preventive measures.\n:::\n\n#### **4.1 Gender, Age Group and Heart Attack Occurrence**\n\nNext, we delve into bivariate analyses to understand correlation of heart attack with various factors. In this section, we will examine if biological factors like aging and gender are associated with heart attack. The figures below show the heart attack occurrence by Gender and Age Groups.\n\nMosaic plots were created using `geom_mosaic()` from the *ggmosaic* package and `ggplot()` from the *ggplot2* package. `labs()`, `theme()` and `scale_fill_manual` from *ggplot2* package were used to change the axis labels, theme and color of the graphs. `scale_y_continuous()` from *ggplot2* was used to display the percentages.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\np1<-ggplot(df)+\n    geom_mosaic(aes(x = product(Heart_Attack_Occurrence, Gender), fill=Heart_Attack_Occurrence))+\n  scale_fill_manual(values=c(\"#DF9999\",\"#99AEDF\")) +\n  theme( axis.ticks.x = element_blank(), legend.position = \"bottom\" )+\n  labs(x = \"Gender\", y= \"Heart Attack\", fill=\"Heart Attack\")+ \n  scale_y_continuous(labels = scales::percent)\n\np2<-ggplot(df)+\n    geom_mosaic(aes(x = product(Heart_Attack_Occurrence, Age_Groups), fill=Heart_Attack_Occurrence))+\n  scale_fill_manual(values=c(\"lightsteelblue\",\"thistle\")) +\n  theme( axis.ticks.x = element_blank(), legend.position = \"bottom\" )+\n  labs(x = \"Age Group\", y= \"Heart Attack\", fill=\"Heart Attack\")+ \n  scale_y_continuous(labels = scales::percent)\n\n(p1+p2)+ plot_annotation(title= \"Heart attack occurrence is not significantly associated with Gender and Age groups\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n::: {.callout-note icon=\"false\"}\n## Insights\n\n-   Based on the stacked bar chart above, the chances of having heart attack is similar for both genders. This suggests that gender is not be a significant differentiator for heart attack occurrence in this study population.\n\n-   Surprisingly, the proportion of Young adults having heart attack is comparable to that of Middle-aged and Old adults. This finding is in disaccordance with common assumptions of heart attack occurring predominantly in older adults, signifying that heart attack may become more common in young adults in the future. Understanding causes and risk factors for heart attack in young adults is therefore pertinent, for the development of effective prevention strategies and government-initiated public health interventions.\n:::\n\n#### **4.2 BMI and Heart Attack Occurrrence**\n\nNext, we examine BMI distribution by age and gender, before investigating association of BMI categories with heart attack occurrence.\n\nThe `ggplot()`, `geom_boxplot()` and `coord_flip()` functions in the *ggplot2* package are used to create the boxplot for BMI grouped by Age groups, colored by gender and change the orientation of the plot. The `stat_halfeye()` function from the *ggdist* package is used to show the BMI distributions for each Age group, by gender. The `theme()` and `lab()` functions in the *ggplot2* package are then used to change axis labels and dictate legend position.\n\nThe `ggbarstats()` and `grouped_ggbarstats()` functions from *ggstatsplot* package are used to create the stacked bar charts with Chi-square test statistics. `digits.perc`, `label.args`, `sample.size.label.args`, `label.args`,ggplot.component\\` were used to specify the label size, color and axis labels.\n\nThe `table()` function is used to create contingency table before applying the chisq.test()\\` function from base R to compute the Chi-square results to extract the Chi-square residuals data.\n\n::: panel-tabset\n## Total Population\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\np1<-ggplot(df, \n       aes(x = Age_Groups, \n           y = BMI,\n           fill=Gender)) +\n  stat_halfeye(adjust = 0.5,\n               justification = -0.1,\n               .width = 0,\n               point_colour = NA,\n                position = position_dodge(0.1)) +\n  geom_boxplot(width = .2,\n               position = position_dodge(0.3),\n               outlier.shape = NA) +\n  labs(x = \"\",\n       y = \"BMI\") +   \n  theme(\n    legend.position = \"right\",\n    axis.title.y = element_text(hjust=1, angle=0)) +\n  coord_flip()+\n  scale_fill_manual(values=alpha(c(\"thistle\", \"lightsteelblue\"),0.35))\n\np2<-ggbarstats(df, \n           y = Heart_Attack_Occurrence, \n           x = BMI_Category,\n           digits.perc = 1,\n           label.args = list(size = 2.5, fill = \"white\"),\n  sample.size.label.args = list(size = 2.5),\n  legend.title = \"BMI\",\n  xlab=\"Heart Attack\",\n  ggplot.component = list(theme( axis.ticks.x=element_blank()), scale_fill_manual(values=c(\"rosybrown2\",\"thistle\",\"lightsteelblue\",\"lightcyan3\"))\n           ))\n\np1/p2\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n## Grouped by age\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\np<-grouped_ggbarstats(df, \n           y = Heart_Attack_Occurrence, \n           x = BMI_Category,\n           digits.perc = 1, \n           grouping.var = Age_Groups, \n           plotgrid.args = list(ncol = 2),\n           sample.size.label.args = list(size = 2.5),\n           label.args = list(size = 2.5, fill = \"white\"), \n           ggplot.component = list(theme(plot.subtitle = element_text(size = 8), axis.ticks.x=element_blank()), scale_fill_manual(values=c(\"rosybrown2\",\"thistle\",\"lightsteelblue\",\"lightcyan3\"))),\n           legend.title = \"BMI\",\n            xlab=\"Heart Attack\")\n```\n:::\n\n\n\n![](images/clipboard-2307200117.png)\n\n## Chi-squared Test\n\nChi-square test residual table for whole population\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Create contingency table\ncontingency_table <- table(df$BMI_Category, df$Heart_Attack_Occurrence)\n\n# Perform chi-square test\nchi_square_test <- chisq.test(contingency_table)\n\n# View the results\npearson_residuals <- chi_square_test$residuals\nprint(pearson_residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             \n                      No        Yes\n  Underweight  0.4921282 -1.4863132\n  Normal      -0.5867653  1.7721340\n  Overweight  -0.1104517  0.3335834\n  Obese        0.7163291 -2.1634392\n```\n\n\n:::\n:::\n\n\n\nChi-square test residual table for Young Adults\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Create contingency table\nsubset_df<-df[df$Age_Groups=='Young',]\ncontingency_table <- table(subset_df$BMI_Category, subset_df$Heart_Attack_Occurrence)\n\n# Perform chi-square test\nchi_square_test <- chisq.test(contingency_table)\n\n# View the results\npearson_residuals <- chi_square_test$residuals\nprint(pearson_residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             \n                      No        Yes\n  Underweight  0.2641421 -0.8146029\n  Normal      -0.4873117  1.5028483\n  Overweight  -0.1114740  0.3437812\n  Obese        0.7150849 -2.2052912\n```\n\n\n:::\n:::\n\n\n:::\n\n::: {.callout-note icon=\"false\"}\n## Insights\n\n-   Distribution of BMI is consistent across age group and gender, resembing a normal distribution. This indicates that BMI is not associated with gender or age in the population.\n\n-   BMI category is associated with heart attack occurrence (Chi-square p-value\\<0.05). Interestingly, there were significantly less obese individuals experiencing heart attack than expected, based on the large negative Chi-square residual value (-2.16). However, when stratified by age groups, this association remained significant for young adults only. This suggests that the association may be age-specific and that the effect of BMI on heart attack occurrence might be more pronounced in younger individuals, who may not have developed other comorbidities yet (e.g., hypertension, high cholesterol).\n:::\n\n#### **4.3 Association of Heart Attack with Hypertension and Cholesterol**\n\nGiven the high incidence of hypertension observed in the earlier section, we will investigate whether hypertension is associated with an increased risk of heart attack.\n\nMosaic plots were created using `geom_mosaic()` from the *ggmosaic* package and `ggplot()` from the *ggplot2* package. `labs()`, `theme()` and `scale_fill_manual` from *ggplot2* package were used to change the axis labels, theme and color of the graphs. `facet_wrap()` was used to facet the mosaic plots by Age Group. `scale_y_continuous()` from *ggplot2* was used to display the percentages.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\np1<-ggplot(data=df) +\n  geom_mosaic(aes(x = product(Blood_Pressure,Heart_Attack_Occurrence), fill=Blood_Pressure))+\n  theme(legend.position=\"right\") +\n  labs(y = \"Blood Pressure\",\n       x = \"Heart Attack\")+\nscale_fill_manual(\"Heart Attack\",values=c( \"lightsteelblue\",\"lightcyan3\", \"thistle\",\"rosybrown2\"))+\n  scale_y_continuous(labels = scales::percent)+\n  facet_wrap(~Age_Groups)\n\np2<-ggplot(data=df) +\n  geom_mosaic(aes(x = product(Cholesterol_Category,Heart_Attack_Occurrence), fill=Cholesterol_Category))+\n  theme(legend.position=\"right\") +\n  labs(y = \"Cholesterol Level\",\n       x = \"Heart Attack Occurrence\")+\nscale_fill_manual(\"Heart Attack\",values=c( \"lightsteelblue\",\"lightcyan3\", \"thistle\"))+\n  facet_wrap(~Age_Groups) + \n  scale_y_continuous(labels = scales::percent)\n\np1/p2 + plot_layout(axis_titles = \"collect\")+ plot_annotation(title= \"Heart Attack is not significantly associated with Hypertension and Cholesterol Level\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\n::: {.callout-note icon=\"false\"}\n## Insights\n\n-   Heart attack occurrence does not significantly increase in groups with hypertension or elevated blood pressure, compared to normal blood pressure, across all age groups.\n\n-   Similarly, individuals with elevated cholesterol levels do not have increased risk of heart attack occurrence regardless of age groups.\n\n-   The findings suggests that high blood pressure or cholesterol levels alone may only have a small impact on heart attack risk or that medication adherence and lifestyle modifications could play a role in mitigating the associated risks. The overall heart attack risk for an individual may only become more pronounced when multiple factors are accounted for, as presence of multiple risk factors simultaneously compounds the overall risks since each condition can exacerbate the others.\n:::\n\n#### **4.4 Association of Heart Attack with Medical History**\n\nHeart attack is typically caused by a combination of various interrelated risk factors. Therefore, it is essential to examine other factors such as underlying medical conditions, family history, and lifestyle choices. These factors may interact in complex ways, increasing the likelihood of heart attacks.\n\nIn this section, we will investigate if Diabetes History and Family History increases tendency of heart attack occurrence.\n\n::: panel-tabset\n## Family history & Diabetes Mosaic Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\np1<-ggplot(data=df) +\n  geom_mosaic(aes(x = product(Heart_Attack_Occurrence,Diabetes_History), fill=Heart_Attack_Occurrence))+\n  theme(legend.position=\"right\") +\n  labs(x = \"Diabetes History\",\n       y = \"Heart Attack Occurrence\")+\nscale_fill_manual(\"Heart Attack\",values=c( \"lightsteelblue\", \"thistle\"))+\n  scale_y_continuous(labels = scales::percent)\n\np2<-ggplot(data=df) +\n  geom_mosaic(aes(x = product(Heart_Attack_Occurrence,Family_History), fill=Heart_Attack_Occurrence))+\n  theme(legend.position=\"right\") +\n  labs(x = \"Family History\",\n       y = \"Heart Attack Occurrence\")+\nscale_fill_manual(\"Heart Attack\",values=c( \"lightsteelblue\", \"thistle\"))+\n  facet_wrap(~Age_Groups) + \n  scale_y_continuous(labels = scales::percent)\np2/p1\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n## Diabetes by Age Group\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\ngrouped_ggbarstats(df, \n           y = Heart_Attack_Occurrence, \n           x = Diabetes_History,\n           digits.perc = 1, \n           grouping.var = Age_Groups, \n           plotgrid.args = list(ncol = 2),\n           sample.size.label.args = list(size = 2.5),\n           label.args = list(size = 2.5, fill = \"white\"), \n           legend.title = \"Diabetes History\",\n           xlab=\"Heart Attack\",\n           ggplot.component = list(theme(plot.subtitle = element_text(size = 8), axis.ticks.x=element_blank()),scale_fill_manual(values = c(\"thistle\",\"lightsteelblue\"))))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n\n![](images/clipboard-4138769921.png)\n\n## Chi-square test\n\nChi-square test residual table for Young Adults\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Create contingency table\nsubset_df<-df[df$Age_Groups=='Young',]\ncontingency_table <- table(subset_df$Diabetes_History, subset_df$Heart_Attack_Occurrence)\n\n# Perform chi-square test\nchi_square_test <- chisq.test(contingency_table)\n\n# View the results\npearson_residuals <- chi_square_test$residuals\nprint(pearson_residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     \n              No        Yes\n  No   0.3881721 -1.1971061\n  Yes -0.7609653  2.3467842\n```\n\n\n:::\n:::\n\n\n:::\n\n::: {.callout-note icon=\"false\"}\n## Insights\n\n-   Proportion of individuals with heart attack did not differ significantly between groups with or without family history, across the age groups.\n\n-   Interestingly, proportion of individuals who have experienced heart attack was similar for individuals with or without diabetes history for the overall population but heart attack occurrence is associated with diabetes history in Young Adults (Chi-square p-value\\<0.05) when the data is age-stratified. There is increased tendency of young adults with diabetes history experiencing heart attack compared to young adults without diabetes history, based on the large positive Chi-square residual value of 2.34.\n:::\n\n#### **4.5 Lifestyle Factors and Heart Attack Occurrence**\n\nIn this section, we will investigate if lifestyle factors like physical activity, diet quality and alcohol consumption are associated with heart attack.\n\nThe `gglikert()` function from *ggstats* package is used to create the diverging bar charts. `scale_fill_brewer()`, `theme()` and `labs()` from \\*ggplot2\\` package is used to set the color palette, change axis labels and ticks.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Create the subset data for \"Yes\" and \"No\" heart attack occurrences\nHA_y <- df %>% filter(Heart_Attack_Occurrence == \"Yes\") %>% select(Physical_Activity, Diet_Quality, Alcohol_Consumption)\nHA_n <- df %>% filter(Heart_Attack_Occurrence == \"No\") %>% select(Physical_Activity, Diet_Quality, Alcohol_Consumption)\n\n# Find the maximum length of the two subsets\nmax_len <- max(nrow(HA_y), nrow(HA_n))\n\n# Pad the shorter dataframe with NAs\nHA_y <- bind_rows(HA_y, data.frame(Physical_Activity = rep(NA, max_len - nrow(HA_y)), Diet_Quality = rep(NA, max_len - nrow(HA_y)),Alcohol_Consumption = rep(NA, max_len - nrow(HA_y))))\n\nPA<-data.frame(Yes=HA_y$Physical_Activity, No=HA_n$Physical_Activity)\n\nDQ<-data.frame(Yes=HA_y$Diet_Quality, No=HA_n$Diet_Quality)\n\nAC<-data.frame(Yes=HA_y$Alcohol_Consumption, No=HA_n$Alcohol_Consumption)\n\np1<-gglikert(PA) + \n  scale_fill_brewer(palette=\"Blues\") +\n  labs(x=\"Physical Activity\", y=\"Heart Attack\")+\n  theme(axis.ticks.x = element_blank(), \n        axis.ticks.y = element_blank(),\n        axis.text.x=element_blank())\n\np2<-gglikert(DQ) + \n  scale_fill_brewer(palette=\"Set1\") +\n  labs(x=\"Diet Quality\", y=\"Heart Attack\")+\n  theme(axis.ticks.x = element_blank(), \n        axis.ticks.y = element_blank(),\n        axis.text.x=element_blank())\n\n\np3<-gglikert(AC) + \n  scale_fill_brewer(palette=\"Blues\") +\n  labs(x=\"Alcohol Consumption\", y=\"Heart Attack\")+\n  theme(axis.ticks.x = element_blank(), \n        axis.ticks.y = element_blank(),\n        axis.text.x=element_blank())\n\n(p1+p2)/p3+ plot_annotation(title=\"Heart attack is not associated with Physical Activity, Diet Quality\\n&Alcohol consumption\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n::: {.callout-note icon=\"false\"}\n## Insights\n\n-   Heart attack occurrence does not vary significantly with Physical Activity, Diet Quality and Alcohol Consumption. This suggests that lifestyle factors may a secondary or insignificant role in heart attack risk for the study population. However, the data for these variables are measured on a likert scale which may be prone to biases, leading to potential inaccuracies and weaken the observed relationship between lifestyle factors and heart attack occurrence.\n:::\n\n### **5 Conclusion**\n\nOur analyses reveals a high prevalence of heart attack occurrence in the Japanese population, with approximately 10% affected, raising a cause for concern and emphasizes a pressing need for targeted cardiovascular health initiatives. Furthermore, significant portions of the population suffers from hypertension, elevated cholesterol levels, and/or are overweight or obese, all of which are well-known risk factors for heart disease.\n\nMore importantly, heart attack incidence is comparable between young adults (18-39) and adults aged 40 and above, highlighting an emerging concern for cardiovascular health in younger populations. In our analyses, BMI category was found to be associated with heart attack occurrence, particularly in young adults, suggesting age-specific effects. Diabetes history was additionally associated with heart attack in young adults.\n\nOn the other hand, hypertension, elevated cholesterol levels, family history, physical activity, diet quality, and alcohol consumption did not show a significant relationship with heart attack occurrence in this population.\n\nThese findings underscore the need for more comprehensive studies to identify heart attack risk factors among younger adults. Future research and analyses could focus on exploring the complex interactions between risk factors to provide a clearer understanding of the risk profiles for heart attack in different demographic groups.\n\n### **6 References**\n\n-   [Heart Attack Research](https://www.sciencedaily.com/releases/2019/03/190307081026.htm)\n-   [Blood Pressure Categories](https://www.heart.org/en/health-topics/high-blood-pressure/understanding-blood-pressure-readings)\n-   [BMI Categories](https://www.cdc.gov/bmi/adult-calculator/bmi-categories.html)\n-   [Cholesterol Level Categories](https://www.myheart.org.sg/heart-news/cholesterol-levels/)\n-   [Chi-square test](https://www.datacamp.com/tutorial/chi-square-test-r)\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}